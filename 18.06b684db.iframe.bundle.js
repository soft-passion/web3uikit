(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{"./node_modules/@toruslabs/solana-embed/dist/solanaEmbed.esm.js":function(module,__webpack_exports__,__webpack_require__){"use strict";(function(Buffer){__webpack_require__.d(__webpack_exports__,"a",(function(){return Torus}));var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@babel/runtime/helpers/defineProperty.js"),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__),_solana_web3_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@solana/web3.js/lib/index.browser.esm.js"),_toruslabs_base_controllers__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@toruslabs/base-controllers/dist/baseControllers.esm.js"),_toruslabs_http_helpers__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@toruslabs/http-helpers/dist/httpHelpers.esm.js"),_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@toruslabs/openlogin-jrpc/dist/openloginJrpc.esm.js"),eth_rpc_errors__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/eth-rpc-errors/dist/index.js"),is_stream__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/is-stream/index.js"),pump__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/pump/index.js"),pump__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(pump__WEBPACK_IMPORTED_MODULE_7__),loglevel__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/loglevel/lib/loglevel.js"),loglevel__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_8__),fast_deep_equal__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/fast-deep-equal/index.js"),fast_deep_equal__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(fast_deep_equal__WEBPACK_IMPORTED_MODULE_9__),messages_errors={disconnected:()=>"Torus: Lost connection to Torus.",permanentlyDisconnected:()=>"Torus: Disconnected from iframe. Page reload required.",unsupportedSync:method=>"Torus: The Torus Ethereum provider does not support synchronous methods like ".concat(method," without a callback parameter."),invalidDuplexStream:()=>"Must provide a Node.js-style duplex stream.",invalidOptions:maxEventListeners=>"Invalid options. Received: { maxEventListeners: ".concat(maxEventListeners,"}"),invalidRequestArgs:()=>"Expected a single, non-array, object argument.",invalidRequestMethod:()=>"'args.method' must be a non-empty string.",invalidRequestParams:()=>"'args.params' must be an object or array if provided.",invalidLoggerObject:()=>"'args.logger' must be an object if provided.",invalidLoggerMethod:method=>"'args.logger' must include required method '".concat(method,"'.")},messages_info={connected:chainId=>'Torus: Connected to chain with ID "'.concat(chainId,'".')};const TORUS_BUILD_ENV={PRODUCTION:"production",DEVELOPMENT:"development",TESTING:"testing"},BUTTON_POSITION={BOTTOM_LEFT:"bottom-left",TOP_LEFT:"top-left",BOTTOM_RIGHT:"bottom-right",TOP_RIGHT:"top-right"};var configuration={supportedVerifierList:["google","reddit","discord"],api:"https://api.tor.us",translations:{en:{embed:{continue:"Continue",actionRequired:"Authorization required",pendingAction:"Click continue to proceed with your request in a popup",cookiesRequired:"Cookies Required",enableCookies:"Please enable cookies in your browser preferences to access Torus",clickHere:"More Info"}},de:{embed:{continue:"Fortsetzen",actionRequired:"Autorisierung erforderlich",pendingAction:"Klicken Sie in einem Popup auf Weiter, um mit Ihrer Anfrage fortzufahren",cookiesRequired:"Cookies benötigt",enableCookies:"Bitte aktivieren Sie Cookies in Ihren Browsereinstellungen, um auf Torus zuzugreifen",clickHere:"Mehr Info"}},ja:{embed:{continue:"継続する",actionRequired:"認証が必要です",pendingAction:"続行をクリックして、ポップアップでリクエストを続行します",cookiesRequired:"必要なクッキー",enableCookies:"Torusにアクセスするには、ブラウザの設定でCookieを有効にしてください。",clickHere:"詳しくは"}},ko:{embed:{continue:"계속하다",actionRequired:"승인 필요",pendingAction:"팝업에서 요청을 진행하려면 계속을 클릭하십시오.",cookiesRequired:"쿠키 필요",enableCookies:"브라우저 환경 설정에서 쿠키를 활성화하여 Torus에 액세스하십시오.",clickHere:"더 많은 정보"}},zh:{embed:{continue:"继续",actionRequired:"需要授权",pendingAction:"单击继续以在弹出窗口中继续您的请求",cookiesRequired:"必填Cookie",enableCookies:"请在您的浏览器首选项中启用cookie以访问Torus。",clickHere:"更多信息"}}},prodTorusUrl:"",localStorageKey:"torus-".concat(window.location.hostname)},log=loglevel__WEBPACK_IMPORTED_MODULE_8___default.a.getLogger("solana-embed");const getWindowId=()=>Math.random().toString(36).slice(2),getTorusUrl=async buildEnv=>{let torusUrl,logLevel;switch(buildEnv){case"testing":torusUrl="https://solana-testing.tor.us",logLevel="debug";break;case"development":torusUrl="http://localhost:8080",logLevel="debug";break;default:torusUrl="https://solana.tor.us",logLevel="error"}return{torusUrl:torusUrl,logLevel:logLevel}},FEATURES_PROVIDER_CHANGE_WINDOW={height:660,width:375},FEATURES_DEFAULT_WALLET_WINDOW={height:740,width:1315},FEATURES_DEFAULT_POPUP_WINDOW={height:700,width:1200},FEATURES_CONFIRM_WINDOW={height:600,width:400};function getPopupFeatures(_ref){let{width:w,height:h}=_ref;const dualScreenLeft=void 0!==window.screenLeft?window.screenLeft:window.screenX,dualScreenTop=void 0!==window.screenTop?window.screenTop:window.screenY,width=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:window.screen.width,height=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:window.screen.height,left=Math.abs((width-w)/2/1+dualScreenLeft),top=Math.abs((height-h)/2/1+dualScreenTop);return"titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=".concat(h/1,",width=").concat(w/1,",top=").concat(top,",left=").concat(left)}class BaseProvider extends _toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_4__.e{constructor(connectionStream,_ref){let{maxEventListeners:maxEventListeners=100,jsonRpcStreamName:jsonRpcStreamName="provider"}=_ref;if(super(),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this,"isTorus",void 0),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this,"_rpcEngine",void 0),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this,"jsonRpcConnectionEvents",void 0),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this,"_state",void 0),!Object(is_stream__WEBPACK_IMPORTED_MODULE_6__.duplex)(connectionStream))throw new Error(messages_errors.invalidDuplexStream());this.isTorus=!0,this.setMaxListeners(maxEventListeners),this._handleConnect=this._handleConnect.bind(this),this._handleDisconnect=this._handleDisconnect.bind(this),this._handleStreamDisconnect=this._handleStreamDisconnect.bind(this),this._rpcRequest=this._rpcRequest.bind(this),this._initializeState=this._initializeState.bind(this),this.request=this.request.bind(this),this.sendAsync=this.sendAsync.bind(this);const mux=new _toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_4__.c;pump__WEBPACK_IMPORTED_MODULE_7___default()(connectionStream,mux,connectionStream,this._handleStreamDisconnect.bind(this,"Torus")),mux.ignoreStream("phishing");const jsonRpcConnection=Object(_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_4__.i)();pump__WEBPACK_IMPORTED_MODULE_7___default()(jsonRpcConnection.stream,mux.createStream(jsonRpcStreamName),jsonRpcConnection.stream,this._handleStreamDisconnect.bind(this,"Torus RpcProvider"));const rpcEngine=new _toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_4__.b;rpcEngine.push(Object(_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_4__.g)()),rpcEngine.push(function createErrorMiddleware(){return(req,res,next)=>{"string"==typeof req.method&&req.method||(res.error=eth_rpc_errors__WEBPACK_IMPORTED_MODULE_5__.ethErrors.rpc.invalidRequest({message:"The request 'method' must be a non-empty string.",data:req})),next((done=>{const{error:error}=res;return error?(log.error("Torus - RPC Error: ".concat(error.message),error),done()):done()}))}}()),rpcEngine.push(Object(_toruslabs_base_controllers__WEBPACK_IMPORTED_MODULE_2__.h)({origin:location.origin})),rpcEngine.push(jsonRpcConnection.middleware),this._rpcEngine=rpcEngine,this.jsonRpcConnectionEvents=jsonRpcConnection.events}async request(args){if(!args||"object"!=typeof args||Array.isArray(args))throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_5__.ethErrors.rpc.invalidRequest({message:messages_errors.invalidRequestArgs(),data:args});const{method:method,params:params}=args;if("string"!=typeof method||0===method.length)throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_5__.ethErrors.rpc.invalidRequest({message:messages_errors.invalidRequestMethod(),data:args});if(void 0!==params&&!Array.isArray(params)&&("object"!=typeof params||null===params))throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_5__.ethErrors.rpc.invalidRequest({message:messages_errors.invalidRequestParams(),data:args});return new Promise(((resolve,reject)=>{this._rpcRequest({method:method,params:params},Object(_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_4__.j)(resolve,reject))}))}send(payload,callback){this._rpcRequest(payload,callback)}sendAsync(payload){return new Promise(((resolve,reject)=>{this._rpcRequest(payload,Object(_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_4__.j)(resolve,reject))}))}_handleStreamDisconnect(streamName,error){!function logStreamDisconnectWarning(remoteLabel,error,emitter){let warningMsg='Torus: Lost connection to "'.concat(remoteLabel,'".');null!=error&&error.stack&&(warningMsg+="\n".concat(error.stack)),log.warn(warningMsg),emitter&&emitter.listenerCount("error")>0&&emitter.emit("error",warningMsg)}(streamName,error,this),this._handleDisconnect(!1,error?error.message:void 0)}}async function documentReady(){return new Promise((resolve=>{"loading"!==document.readyState?resolve():function(handle,eventName,handler){for(var _len=arguments.length,handlerArgs=new Array(_len>3?_len-3:0),_key=3;_key<_len;_key++)handlerArgs[_key-3]=arguments[_key];const handlerWrapper=()=>{handler(...handlerArgs),handle.removeEventListener(eventName,handlerWrapper)};handle.addEventListener(eventName,handlerWrapper)}(document,"DOMContentLoaded",resolve)}))}const htmlToElement=html=>{const template=window.document.createElement("template"),trimmedHtml=html.trim();return template.innerHTML=trimmedHtml,template.content.firstChild};class PopupHandler extends _toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_4__.e{constructor(_ref){let{url:url,target:target,features:features}=_ref;super(),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this,"url",void 0),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this,"target",void 0),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this,"features",void 0),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this,"window",void 0),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this,"windowTimer",void 0),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this,"iClosedWindow",void 0),this.url=url,this.target=target||"_blank",this.features=features||getPopupFeatures(FEATURES_DEFAULT_POPUP_WINDOW),this.window=void 0,this.windowTimer=void 0,this.iClosedWindow=!1,this._setupTimer()}_setupTimer(){this.windowTimer=Number(setInterval((()=>{this.window&&this.window.closed&&(clearInterval(this.windowTimer),this.iClosedWindow||this.emit("close"),this.iClosedWindow=!1,this.window=void 0),void 0===this.window&&clearInterval(this.windowTimer)}),500))}open(){var _this$window;return this.window=window.open(this.url.href,this.target,this.features),null!==(_this$window=this.window)&&void 0!==_this$window&&_this$window.focus&&this.window.focus(),Promise.resolve()}close(){this.iClosedWindow=!0,this.window&&this.window.close()}redirect(locationReplaceOnRedirect){locationReplaceOnRedirect?window.location.replace(this.url.href):window.location.href=this.url.href}}function ownKeys$2(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}class TorusCommunicationProvider extends BaseProvider{constructor(connectionStream,_ref){let{maxEventListeners:maxEventListeners=100,jsonRpcStreamName:jsonRpcStreamName="provider"}=_ref;super(connectionStream,{maxEventListeners:maxEventListeners,jsonRpcStreamName:jsonRpcStreamName}),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this,"embedTranslations",void 0),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this,"torusUrl",void 0),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this,"dappStorageKey",void 0),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this,"windowRefs",void 0),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this,"tryWindowHandle",void 0),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this,"torusAlertContainer",void 0),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this,"torusIframe",void 0),this._state=function _objectSpread$2(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys$2(Object(source),!0).forEach((function(key){_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys$2(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}({},TorusCommunicationProvider._defaultState),this.torusUrl="",this.dappStorageKey="";const languageTranslations=configuration.translations[(()=>{let userLanguage=window.navigator.language||"en-US";const userLanguages=userLanguage.split("-");return userLanguage=Object.prototype.hasOwnProperty.call(configuration.translations,userLanguages[0])?userLanguages[0]:"en",userLanguage})()];this.embedTranslations=languageTranslations.embed,this.windowRefs={},this.on("connect",(()=>{this._state.isConnected=!0}));this.jsonRpcConnectionEvents.on("notification",(payload=>{const{method:method,params:params}=payload;if(method===_toruslabs_base_controllers__WEBPACK_IMPORTED_MODULE_2__.c.IFRAME_STATUS){const{isFullScreen:isFullScreen,rid:rid}=params;this._displayIframe({isFull:isFullScreen,rid:rid})}else if(method===_toruslabs_base_controllers__WEBPACK_IMPORTED_MODULE_2__.c.CREATE_WINDOW){const{windowId:windowId,url:url}=params;this._createPopupBlockAlert(windowId,url)}else if(method===_toruslabs_base_controllers__WEBPACK_IMPORTED_MODULE_2__.c.CLOSE_WINDOW)this._handleCloseWindow(params);else if(method===_toruslabs_base_controllers__WEBPACK_IMPORTED_MODULE_2__.c.USER_LOGGED_IN){const{currentLoginProvider:currentLoginProvider}=params;this._state.isLoggedIn=!0,this._state.currentLoginProvider=currentLoginProvider}else method===_toruslabs_base_controllers__WEBPACK_IMPORTED_MODULE_2__.c.USER_LOGGED_OUT&&(this._state.isLoggedIn=!1,this._state.currentLoginProvider=null,this._displayIframe())}))}get isLoggedIn(){return this._state.isLoggedIn}get isIFrameFullScreen(){return this._state.isIFrameFullScreen}isConnected(){return this._state.isConnected}async _initializeState(params){try{const{torusUrl:torusUrl,dappStorageKey:dappStorageKey,torusAlertContainer:torusAlertContainer,torusIframe:torusIframe}=params;this.torusUrl=torusUrl,this.dappStorageKey=dappStorageKey,this.torusAlertContainer=torusAlertContainer,this.torusIframe=torusIframe,this.torusIframe.addEventListener("load",(()=>{this._state.isIFrameFullScreen||this._displayIframe()}));const{currentLoginProvider:currentLoginProvider,isLoggedIn:isLoggedIn}=await this.request({method:_toruslabs_base_controllers__WEBPACK_IMPORTED_MODULE_2__.b.GET_PROVIDER_STATE,params:[]});this._handleConnect(currentLoginProvider,isLoggedIn)}catch(error){log.error("Torus: Failed to get initial state. Please report this bug.",error)}finally{log.info("initialized communication state"),this._state.initialized=!0,this.emit("_initialized")}}_handleWindow(windowId){let{url:url,target:target,features:features}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const finalUrl=new URL(url||"".concat(this.torusUrl,"/redirect?windowId=").concat(windowId));this.dappStorageKey&&(finalUrl.hash?finalUrl.hash+="&dappStorageKey=".concat(this.dappStorageKey):finalUrl.hash="#dappStorageKey=".concat(this.dappStorageKey));const handledWindow=new PopupHandler({url:finalUrl,target:target,features:features});handledWindow.open(),handledWindow.window?(this.windowRefs[windowId]=handledWindow,this.request({method:_toruslabs_base_controllers__WEBPACK_IMPORTED_MODULE_2__.b.OPENED_WINDOW,params:{windowId:windowId}}),handledWindow.once("close",(()=>{delete this.windowRefs[windowId],this.request({method:_toruslabs_base_controllers__WEBPACK_IMPORTED_MODULE_2__.b.CLOSED_WINDOW,params:{windowId:windowId}})}))):this._createPopupBlockAlert(windowId,finalUrl.href)}_displayIframe(){let{isFull:isFull=!1,rid:rid=""}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const style={};if(isFull)style.display="block",style.width="100%",style.height="100%",style.top="0px",style.right="0px",style.left="0px",style.bottom="0px";else switch(style.display=this._state.torusWidgetVisibility?"block":"none",style.height="70px",style.width="70px",this._state.buttonPosition){case BUTTON_POSITION.TOP_LEFT:style.top="0px",style.left="0px",style.right="auto",style.bottom="auto";break;case BUTTON_POSITION.TOP_RIGHT:style.top="0px",style.right="0px",style.left="auto",style.bottom="auto";break;case BUTTON_POSITION.BOTTOM_RIGHT:style.bottom="0px",style.right="0px",style.top="auto",style.left="auto";break;case BUTTON_POSITION.BOTTOM_LEFT:default:style.bottom="0px",style.left="0px",style.top="auto",style.right="auto"}Object.assign(this.torusIframe.style,style),this._state.isIFrameFullScreen=isFull,this.request({method:_toruslabs_base_controllers__WEBPACK_IMPORTED_MODULE_2__.b.IFRAME_STATUS,params:{isIFrameFullScreen:isFull,rid:rid}})}hideTorusButton(){this._state.torusWidgetVisibility=!1,this._displayIframe()}showTorusButton(){this._state.torusWidgetVisibility=!0,this._displayIframe()}_rpcRequest(payload,callback){const cb=callback,_payload=payload;Array.isArray(_payload)||_payload.jsonrpc||(_payload.jsonrpc="2.0"),this.tryWindowHandle(_payload,cb)}_handleConnect(currentLoginProvider,isLoggedIn){this._state.isConnected||(this._state.isConnected=!0,this.emit("connect",{currentLoginProvider:currentLoginProvider,isLoggedIn:isLoggedIn}),log.debug(messages_info.connected(currentLoginProvider)))}_handleDisconnect(isRecoverable,errorMessage){if(this._state.isConnected||!this._state.isPermanentlyDisconnected&&!isRecoverable){let error;this._state.isConnected=!1,isRecoverable?(error=new eth_rpc_errors__WEBPACK_IMPORTED_MODULE_5__.EthereumRpcError(1013,errorMessage||messages_errors.disconnected()),log.debug(error)):(error=new eth_rpc_errors__WEBPACK_IMPORTED_MODULE_5__.EthereumRpcError(1011,errorMessage||messages_errors.permanentlyDisconnected()),log.error(error),this._state.currentLoginProvider=null,this._state.isLoggedIn=!1,this._state.torusWidgetVisibility=!1,this._state.isIFrameFullScreen=!1,this._state.isPermanentlyDisconnected=!0),this.emit("disconnect",error)}}_handleCloseWindow(params){const{windowId:windowId}=params;this.windowRefs[windowId]&&(this.windowRefs[windowId].close(),delete this.windowRefs[windowId])}async _createPopupBlockAlert(windowId,url){const logoUrl=this.getLogoUrl(),torusAlert=htmlToElement('<div id="torusAlert" class="torus-alert--v2">'+'<div id="torusAlert__logo"><img src="'.concat(logoUrl,'" /></div>')+"<div>"+'<h1 id="torusAlert__title">'.concat(this.embedTranslations.actionRequired,"</h1>")+'<p id="torusAlert__desc">'.concat(this.embedTranslations.pendingAction,"</p>")+"</div></div>"),successAlert=htmlToElement('<div><a id="torusAlert__btn">'.concat(this.embedTranslations.continue,"</a></div>")),btnContainer=htmlToElement('<div id="torusAlert__btn-container"></div>');btnContainer.appendChild(successAlert),torusAlert.appendChild(btnContainer);await documentReady(),(()=>{this.torusAlertContainer.appendChild(torusAlert)})(),(()=>{successAlert.addEventListener("click",(()=>{this._handleWindow(windowId,{url:url,target:"_blank",features:getPopupFeatures(FEATURES_CONFIRM_WINDOW)}),torusAlert.remove(),0===this.torusAlertContainer.children.length&&(this.torusAlertContainer.style.display="none")}))})(),this.torusAlertContainer.style.display="block"}getLogoUrl(){return"".concat(this.torusUrl,"/images/torus_icon-blue.svg")}}function ownKeys$1(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(TorusCommunicationProvider,"_defaultState",{buttonPosition:"bottom-left",currentLoginProvider:null,isIFrameFullScreen:!1,hasEmittedConnection:!1,torusWidgetVisibility:!1,initialized:!1,isLoggedIn:!1,isPermanentlyDisconnected:!1,isConnected:!1});class TorusInPageProvider extends BaseProvider{constructor(connectionStream,_ref){let{maxEventListeners:maxEventListeners=100,jsonRpcStreamName:jsonRpcStreamName="provider"}=_ref;super(connectionStream,{maxEventListeners:maxEventListeners,jsonRpcStreamName:jsonRpcStreamName}),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this,"chainId",void 0),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this,"selectedAddress",void 0),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this,"tryWindowHandle",void 0),this._state=function _objectSpread$1(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys$1(Object(source),!0).forEach((function(key){_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys$1(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}({},TorusInPageProvider._defaultState),this.selectedAddress=null,this.chainId=null,this._handleAccountsChanged=this._handleAccountsChanged.bind(this),this._handleChainChanged=this._handleChainChanged.bind(this),this._handleUnlockStateChanged=this._handleUnlockStateChanged.bind(this),this.on("connect",(()=>{this._state.isConnected=!0}));this.jsonRpcConnectionEvents.on("notification",(payload=>{const{method:method,params:params}=payload;method===_toruslabs_base_controllers__WEBPACK_IMPORTED_MODULE_2__.e.ACCOUNTS_CHANGED?this._handleAccountsChanged(params):method===_toruslabs_base_controllers__WEBPACK_IMPORTED_MODULE_2__.e.UNLOCK_STATE_CHANGED?this._handleUnlockStateChanged(params):method===_toruslabs_base_controllers__WEBPACK_IMPORTED_MODULE_2__.e.CHAIN_CHANGED&&this._handleChainChanged(params)}))}isConnected(){return this._state.isConnected}async _initializeState(){try{const{accounts:accounts,chainId:chainId,isUnlocked:isUnlocked}=await this.request({method:_toruslabs_base_controllers__WEBPACK_IMPORTED_MODULE_2__.d.GET_PROVIDER_STATE,params:[]});this.emit("connect",{chainId:chainId}),this._handleChainChanged({chainId:chainId}),this._handleUnlockStateChanged({accounts:accounts,isUnlocked:isUnlocked}),this._handleAccountsChanged(accounts)}catch(error){log.error("Torus: Failed to get initial state. Please report this bug.",error)}finally{log.info("initialized provider state"),this._state.initialized=!0,this.emit("_initialized")}}_rpcRequest(payload,callback){let isInternal=arguments.length>2&&void 0!==arguments[2]&&arguments[2],cb=callback;const _payload=payload;if(!Array.isArray(_payload))if(_payload.jsonrpc||(_payload.jsonrpc="2.0"),"solana_accounts"===_payload.method||"solana_requestAccounts"===_payload.method)cb=(err,res)=>{this._handleAccountsChanged(res.result||[],"solana_accounts"===_payload.method,isInternal),callback(err,res)};else if("wallet_getProviderState"===_payload.method)return void this._rpcEngine.handle(payload,cb);this.tryWindowHandle(_payload,cb)}_handleConnect(chainId){this._state.isConnected||(this._state.isConnected=!0,this.emit("connect",{chainId:chainId}),log.debug(messages_info.connected(chainId)))}_handleDisconnect(isRecoverable,errorMessage){if(this._state.isConnected||!this._state.isPermanentlyDisconnected&&!isRecoverable){let error;this._state.isConnected=!1,isRecoverable?(error=new eth_rpc_errors__WEBPACK_IMPORTED_MODULE_5__.EthereumRpcError(1013,errorMessage||messages_errors.disconnected()),log.debug(error)):(error=new eth_rpc_errors__WEBPACK_IMPORTED_MODULE_5__.EthereumRpcError(1011,errorMessage||messages_errors.permanentlyDisconnected()),log.error(error),this.chainId=null,this._state.accounts=null,this.selectedAddress=null,this._state.isUnlocked=!1,this._state.isPermanentlyDisconnected=!0),this.emit("disconnect",error)}}_handleAccountsChanged(accounts){let isEthAccounts=arguments.length>1&&void 0!==arguments[1]&&arguments[1],isInternal=arguments.length>2&&void 0!==arguments[2]&&arguments[2],finalAccounts=accounts;Array.isArray(finalAccounts)||(log.error("Torus: Received non-array accounts parameter. Please report this bug.",finalAccounts),finalAccounts=[]);for(const account of accounts)if("string"!=typeof account){log.error("Torus: Received non-string account. Please report this bug.",accounts),finalAccounts=[];break}fast_deep_equal__WEBPACK_IMPORTED_MODULE_9___default()(this._state.accounts,finalAccounts)||(isEthAccounts&&Array.isArray(this._state.accounts)&&this._state.accounts.length>0&&!isInternal&&log.error('Torus: "solana_accounts" unexpectedly updated accounts. Please report this bug.',finalAccounts),this._state.accounts=finalAccounts,this.emit("accountsChanged",finalAccounts)),this.selectedAddress!==finalAccounts[0]&&(this.selectedAddress=finalAccounts[0]||null)}_handleChainChanged(){let{chainId:chainId}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};chainId?"loading"===chainId?this._handleDisconnect(!0):(this._handleConnect(chainId),chainId!==this.chainId&&(this.chainId=chainId,this._state.initialized&&this.emit("chainChanged",this.chainId))):log.error("Torus: Received invalid network parameters. Please report this bug.",{chainId:chainId})}_handleUnlockStateChanged(){let{accounts:accounts,isUnlocked:isUnlocked}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"boolean"==typeof isUnlocked?isUnlocked!==this._state.isUnlocked&&(this._state.isUnlocked=isUnlocked,this._handleAccountsChanged(accounts||[])):log.error("Torus: Received invalid isUnlocked parameter. Please report this bug.",{isUnlocked:isUnlocked})}}function imgExists(url){return new Promise(((resolve,reject)=>{try{const img=document.createElement("img");img.onload=()=>resolve(!0),img.onerror=()=>resolve(!1),img.src=url}catch(e){reject(e)}}))}_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(TorusInPageProvider,"_defaultState",{accounts:null,isConnected:!1,isUnlocked:!1,initialized:!1,isPermanentlyDisconnected:!1,hasEmittedConnection:!1});const getSiteName=window=>{const{document:document}=window,siteName=document.querySelector('head > meta[property="og:site_name"]');if(siteName)return siteName.content;const metaTitle=document.querySelector('head > meta[name="title"]');return metaTitle?metaTitle.content:document.title&&document.title.length>0?document.title:window.location.hostname};async function getSiteIcon(window){try{const{document:document}=window;let icon=document.querySelector('head > link[rel="shortcut icon"]');return icon&&await imgExists(icon.href)?icon.href:(icon=Array.from(document.querySelectorAll('head > link[rel="icon"]')).find((_icon=>Boolean(_icon.href))),icon&&await imgExists(icon.href)?icon.href:"")}catch(error){return""}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}const PROVIDER_UNSAFE_METHODS=["send_transaction","sign_transaction","sign_all_transactions","sign_message","connect"],COMMUNICATION_UNSAFE_METHODS=[_toruslabs_base_controllers__WEBPACK_IMPORTED_MODULE_2__.b.SET_PROVIDER],isLocalStorageAvailable=function storageAvailable(type){let storage;try{storage=window[type];const x="__storage_test__";return storage.setItem(x,x),storage.removeItem(x),!0}catch(e){return e&&(22===e.code||1014===e.code||"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name)&&storage&&0!==storage.length}}("localStorage");!async function preLoadIframe(){try{if("undefined"==typeof document)return;const torusIframeHtml=document.createElement("link"),{torusUrl:torusUrl}=await getTorusUrl("production");torusIframeHtml.href="".concat(torusUrl,"/frame"),torusIframeHtml.crossOrigin="anonymous",torusIframeHtml.type="text/html",torusIframeHtml.rel="prefetch",torusIframeHtml.relList&&torusIframeHtml.relList.supports&&torusIframeHtml.relList.supports("prefetch")&&document.head.appendChild(torusIframeHtml)}catch(error){log.warn(error)}}();class Torus{constructor(){let{modalZIndex:modalZIndex=99999}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this,"isInitialized",void 0),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this,"torusAlert",void 0),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this,"modalZIndex",void 0),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this,"alertZIndex",void 0),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this,"requestedLoginProvider",void 0),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this,"provider",void 0),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this,"communicationProvider",void 0),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this,"dappStorageKey",void 0),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this,"torusAlertContainer",void 0),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this,"torusUrl",void 0),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this,"torusIframe",void 0),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this,"styleLink",void 0),this.torusUrl="",this.isInitialized=!1,this.requestedLoginProvider=null,this.modalZIndex=modalZIndex,this.alertZIndex=modalZIndex+1e3,this.dappStorageKey=""}get isLoggedIn(){return!!this.communicationProvider&&this.communicationProvider.isLoggedIn}async init(){let{buildEnv:buildEnv=TORUS_BUILD_ENV.PRODUCTION,enableLogging:enableLogging=!1,network:network,showTorusButton:showTorusButton=!1,useLocalStorage:useLocalStorage=!1,buttonPosition:buttonPosition=BUTTON_POSITION.BOTTOM_LEFT,apiKey:apiKey="torus-default",extraParams:extraParams={}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.isInitialized)throw new Error("Already initialized");Object(_toruslabs_http_helpers__WEBPACK_IMPORTED_MODULE_3__.f)(apiKey);const{torusUrl:torusUrl,logLevel:logLevel}=await getTorusUrl(buildEnv);log.info(torusUrl,"url loaded"),this.torusUrl=torusUrl,log.setDefaultLevel(logLevel),enableLogging?log.enableAll():log.disableAll();const dappStorageKey=this.handleDappStorageKey(useLocalStorage),torusIframeUrl=new URL(torusUrl);torusIframeUrl.pathname.endsWith("/")?torusIframeUrl.pathname+="frame":torusIframeUrl.pathname+="/frame";const hashParams=new URLSearchParams;dappStorageKey&&hashParams.append("dappStorageKey",dappStorageKey),hashParams.append("origin",window.location.origin),torusIframeUrl.hash=hashParams.toString(),this.torusIframe=htmlToElement('<iframe\n        id="torusIframe"\n        class="torusIframe"\n        src="'.concat(torusIframeUrl.href,'"\n        style="display: none; position: fixed; top: 0; right: 0; width: 100%;\n        height: 100%; border: none; border-radius: 0; z-index: ').concat(this.modalZIndex.toString(),'"\n      ></iframe>')),this.torusAlertContainer=htmlToElement('<div id="torusAlertContainer" style="display:none; z-index: '.concat(this.alertZIndex.toString(),'"></div>')),this.styleLink=htmlToElement('<link href="'.concat(torusUrl,'/css/widget.css" rel="stylesheet" type="text/css">'));await documentReady(),await(async()=>new Promise(((resolve,reject)=>{try{window.document.head.appendChild(this.styleLink),window.document.body.appendChild(this.torusIframe),window.document.body.appendChild(this.torusAlertContainer),this.torusIframe.addEventListener("load",(async()=>{const dappMetadata=await(async()=>({name:getSiteName(window),icon:await getSiteIcon(window)}))();this.torusIframe.contentWindow.postMessage({buttonPosition:buttonPosition,apiKey:apiKey,network:network,dappMetadata:dappMetadata,extraParams:extraParams},torusIframeUrl.origin),await this._setupWeb3({torusUrl:torusUrl}),showTorusButton?this.showTorusButton():this.hideTorusButton(),this.isInitialized=!0,window.torus=this,resolve()}))}catch(error){reject(error)}})))()}async login(){let params=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.isInitialized)throw new Error("Call init() first");try{this.requestedLoginProvider=params.loginProvider||null,this.requestedLoginProvider||this.communicationProvider._displayIframe({isFull:!0});const res=await new Promise(((resolve,reject)=>{this.provider._rpcRequest({method:"solana_requestAccounts",params:[this.requestedLoginProvider,params.login_hint]},Object(_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_4__.j)(resolve,reject))}));if(Array.isArray(res)&&res.length>0)return res;throw new Error("Login failed")}catch(error){throw log.error("login failed",error),error}finally{this.communicationProvider.isIFrameFullScreen&&this.communicationProvider._displayIframe()}}async loginWithPrivateKey(loginParams){if(!this.isInitialized)throw new Error("Call init() first");const{privateKey:privateKey,userInfo:userInfo}=loginParams,{success:success}=await this.communicationProvider.request({method:"login_with_private_key",params:{privateKey:privateKey,userInfo:userInfo}});if(!success)throw new Error("Login Failed")}async logout(){if(!this.communicationProvider.isLoggedIn)throw new Error("Not logged in");await this.communicationProvider.request({method:_toruslabs_base_controllers__WEBPACK_IMPORTED_MODULE_2__.b.LOGOUT,params:[]}),this.requestedLoginProvider=null}async cleanUp(){this.communicationProvider.isLoggedIn&&await this.logout(),this.clearInit()}clearInit(){function isElement(element){return element instanceof Element||element instanceof Document}isElement(this.styleLink)&&window.document.body.contains(this.styleLink)&&(this.styleLink.remove(),this.styleLink=void 0),isElement(this.torusIframe)&&window.document.body.contains(this.torusIframe)&&(this.torusIframe.remove(),this.torusIframe=void 0),isElement(this.torusAlertContainer)&&window.document.body.contains(this.torusAlertContainer)&&(this.torusAlert=void 0,this.torusAlertContainer.remove(),this.torusAlertContainer=void 0),this.isInitialized=!1}hideTorusButton(){this.communicationProvider.hideTorusButton()}showTorusButton(){this.communicationProvider.showTorusButton()}async setProvider(params){await this.communicationProvider.request({method:_toruslabs_base_controllers__WEBPACK_IMPORTED_MODULE_2__.b.SET_PROVIDER,params:_objectSpread({},params)})}async showWallet(path){let params=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const instanceId=await this.communicationProvider.request({method:_toruslabs_base_controllers__WEBPACK_IMPORTED_MODULE_2__.b.WALLET_INSTANCE_ID,params:[]}),finalPath=path?"/".concat(path):"",finalUrl=new URL("".concat(this.torusUrl,"/wallet").concat(finalPath));finalUrl.searchParams.append("instanceId",instanceId),Object.keys(params).forEach((x=>{finalUrl.searchParams.append(x,params[x])})),this.dappStorageKey&&(finalUrl.hash="#dappStorageKey=".concat(this.dappStorageKey));new PopupHandler({url:finalUrl,features:getPopupFeatures(FEATURES_DEFAULT_WALLET_WINDOW)}).open()}async getUserInfo(){return await this.communicationProvider.request({method:_toruslabs_base_controllers__WEBPACK_IMPORTED_MODULE_2__.b.USER_INFO,params:[]})}async initiateTopup(provider,params){if(!this.isInitialized)throw new Error("Torus is not initialized");const windowId=getWindowId();this.communicationProvider._handleWindow(windowId);return await this.communicationProvider.request({method:_toruslabs_base_controllers__WEBPACK_IMPORTED_MODULE_2__.b.TOPUP,params:{provider:provider,params:params,windowId:windowId}})}async getAccounts(){return await this.provider.request({method:"getAccounts",params:[]})}async sendTransaction(transaction){return await this.provider.request({method:"send_transaction",params:{message:transaction.serialize({requireAllSignatures:!1}).toString("hex")}})}async signTransaction(transaction){const response=await this.provider.request({method:"sign_transaction",params:{message:transaction.serializeMessage().toString("hex"),messageOnly:!0}}),parsed=JSON.parse(response),signature={publicKey:new _solana_web3_js__WEBPACK_IMPORTED_MODULE_1__.c(parsed.publicKey),signature:Buffer.from(parsed.signature,"hex")};return transaction.addSignature(signature.publicKey,signature.signature),transaction}async signAllTransactions(transactions){const encodedMessage=transactions.map((tx=>tx.serializeMessage().toString("hex"))),signatures=(await this.provider.request({method:"sign_all_transactions",params:{message:encodedMessage,messageOnly:!0}})).map((item=>{const parsed=JSON.parse(item);return{publicKey:new _solana_web3_js__WEBPACK_IMPORTED_MODULE_1__.c(parsed.publicKey),signature:Buffer.from(parsed.signature,"hex")}}));return transactions.forEach(((tx,idx)=>(tx.addSignature(signatures[idx].publicKey,signatures[idx].signature),tx))),transactions}async signMessage(data){return await this.provider.request({method:"sign_message",params:{data:data}})}async getGaslessPublicKey(){return await this.provider.request({method:"get_gasless_public_key",params:[]})}handleDappStorageKey(useLocalStorage){let dappStorageKey="";if(isLocalStorageAvailable&&useLocalStorage){const storedKey=window.localStorage.getItem(configuration.localStorageKey);if(storedKey)dappStorageKey=storedKey;else{const generatedKey="torus-app-".concat(getWindowId());window.localStorage.setItem(configuration.localStorageKey,generatedKey),dappStorageKey=generatedKey}}return this.dappStorageKey=dappStorageKey,dappStorageKey}async _setupWeb3(providerParams){log.info("setupWeb3 running");const providerStream=new _toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_4__.a({name:"embed_torus",target:"iframe_torus",targetWindow:this.torusIframe.contentWindow}),communicationStream=new _toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_4__.a({name:"embed_communication",target:"iframe_communication",targetWindow:this.torusIframe.contentWindow}),inPageProvider=new TorusInPageProvider(providerStream,{}),communicationProvider=new TorusCommunicationProvider(communicationStream,{});inPageProvider.tryWindowHandle=(payload,cb)=>{const _payload=payload;if(!Array.isArray(_payload)&&PROVIDER_UNSAFE_METHODS.includes(_payload.method)){if(!this.communicationProvider.isLoggedIn)throw new Error("User Not Logged In");const windowId=getWindowId();communicationProvider._handleWindow(windowId,{target:"_blank",features:getPopupFeatures(FEATURES_CONFIRM_WINDOW)}),_payload.windowId=windowId}inPageProvider._rpcEngine.handle(_payload,cb)},communicationProvider.tryWindowHandle=(payload,cb)=>{const _payload=payload;if(!Array.isArray(_payload)&&COMMUNICATION_UNSAFE_METHODS.includes(_payload.method)){const windowId=getWindowId();communicationProvider._handleWindow(windowId,{target:"_blank",features:getPopupFeatures(FEATURES_PROVIDER_CHANGE_WINDOW)}),_payload.params.windowId=windowId}communicationProvider._rpcEngine.handle(_payload,cb)};const detectAccountRequestPrototypeModifier=m=>{const originalMethod=inPageProvider[m],self=this;inPageProvider[m]=function providerFunc(request,cb){const{method:method,params:params=[]}=request;if("solana_requestAccounts"===method){if(!cb)return self.login({loginProvider:params[0]});self.login({loginProvider:params[0]}).then((res=>cb(null,res))).catch((err=>cb(err)))}return originalMethod.apply(this,[request,cb])}};detectAccountRequestPrototypeModifier("request"),detectAccountRequestPrototypeModifier("sendAsync"),detectAccountRequestPrototypeModifier("send");const proxiedInPageProvider=new Proxy(inPageProvider,{deleteProperty:()=>!0}),proxiedCommunicationProvider=new Proxy(communicationProvider,{deleteProperty:()=>!0});this.provider=proxiedInPageProvider,this.communicationProvider=proxiedCommunicationProvider,await Promise.all([inPageProvider._initializeState(),communicationProvider._initializeState(_objectSpread(_objectSpread({},providerParams),{},{dappStorageKey:this.dappStorageKey,torusAlertContainer:this.torusAlertContainer,torusIframe:this.torusIframe}))]),log.debug("Torus - injected provider")}}}).call(this,__webpack_require__("./node_modules/node-libs-browser/node_modules/buffer/index.js").Buffer)},"./node_modules/@web3auth/torus-solana-adapter/dist/torusSolanaAdapter.esm.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"SolanaWalletAdapter",(function(){return SolanaWalletAdapter}));var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@babel/runtime/helpers/defineProperty.js"),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__),_toruslabs_solana_embed__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@toruslabs/solana-embed/dist/solanaEmbed.esm.js"),_web3auth_base__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@web3auth/base/dist/base.esm.js"),_web3auth_solana_provider__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@web3auth/solana-provider/dist/solanaProvider.esm.js"),loglevel__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/loglevel/lib/loglevel.js"),loglevel__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(loglevel__WEBPACK_IMPORTED_MODULE_4__);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}class SolanaWalletAdapter extends _web3auth_base__WEBPACK_IMPORTED_MODULE_2__.e{constructor(){let params=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this,"name",_web3auth_base__WEBPACK_IMPORTED_MODULE_2__.i.TORUS_SOLANA),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this,"adapterNamespace",_web3auth_base__WEBPACK_IMPORTED_MODULE_2__.c.SOLANA),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this,"currentChainNamespace",_web3auth_base__WEBPACK_IMPORTED_MODULE_2__.f.SOLANA),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this,"type",_web3auth_base__WEBPACK_IMPORTED_MODULE_2__.a.EXTERNAL),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this,"status",_web3auth_base__WEBPACK_IMPORTED_MODULE_2__.d.NOT_READY),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this,"torusInstance",null),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this,"torusWalletOptions",void 0),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this,"initParams",void 0),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this,"loginSettings",{}),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this,"solanaProvider",null),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0___default()(this,"rehydrated",!1),this.torusWalletOptions=params.adapterSettings||{},this.initParams=params.initParams||{},this.loginSettings=params.loginSettings||{},this.chainConfig=params.chainConfig||null}get provider(){var _this$solanaProvider;return this.status===_web3auth_base__WEBPACK_IMPORTED_MODULE_2__.d.CONNECTED&&this.solanaProvider&&(null===(_this$solanaProvider=this.solanaProvider)||void 0===_this$solanaProvider?void 0:_this$solanaProvider.provider)||null}set provider(_){throw new Error("Not implemented")}async init(options){let network;if(super.checkInitializationRequirements(),this.chainConfig){const{chainId:chainId,blockExplorer:blockExplorer,displayName:displayName,rpcTarget:rpcTarget,ticker:ticker,tickerName:tickerName}=this.chainConfig;network={chainId:chainId,rpcTarget:rpcTarget,blockExplorerUrl:blockExplorer,displayName:displayName,tickerName:tickerName,ticker:ticker,logo:""}}else{this.chainConfig=Object(_web3auth_base__WEBPACK_IMPORTED_MODULE_2__.m)(_web3auth_base__WEBPACK_IMPORTED_MODULE_2__.f.SOLANA,"0x1");const{blockExplorer:blockExplorer,displayName:displayName,ticker:ticker,tickerName:tickerName,rpcTarget:rpcTarget,chainId:chainId}=this.chainConfig;network={chainId:chainId,rpcTarget:rpcTarget,blockExplorerUrl:blockExplorer,displayName:displayName,ticker:ticker,tickerName:tickerName,logo:""}}this.torusInstance=new _toruslabs_solana_embed__WEBPACK_IMPORTED_MODULE_1__.a(this.torusWalletOptions),await this.torusInstance.init(_objectSpread(_objectSpread({showTorusButton:!1},this.initParams),{},{network:network})),this.solanaProvider=new _web3auth_solana_provider__WEBPACK_IMPORTED_MODULE_3__.TorusInjectedProvider({config:{chainConfig:this.chainConfig}}),this.status=_web3auth_base__WEBPACK_IMPORTED_MODULE_2__.d.READY,this.emit(_web3auth_base__WEBPACK_IMPORTED_MODULE_2__.b.READY,_web3auth_base__WEBPACK_IMPORTED_MODULE_2__.i.TORUS_SOLANA);try{options.autoConnect&&(this.rehydrated=!0,await this.connect())}catch(error){loglevel__WEBPACK_IMPORTED_MODULE_4___default.a.error("Failed to connect with cached torus solana provider",error),this.emit(_web3auth_base__WEBPACK_IMPORTED_MODULE_2__.b.ERRORED,error)}}async connect(){if(super.checkConnectionRequirements(),!this.torusInstance)throw _web3auth_base__WEBPACK_IMPORTED_MODULE_2__.j.notReady("Torus wallet is not initialized");if(!this.solanaProvider)throw _web3auth_base__WEBPACK_IMPORTED_MODULE_2__.j.notReady("Torus wallet is not initialized");this.status=_web3auth_base__WEBPACK_IMPORTED_MODULE_2__.d.CONNECTING,this.emit(_web3auth_base__WEBPACK_IMPORTED_MODULE_2__.b.CONNECTING,{adapter:_web3auth_base__WEBPACK_IMPORTED_MODULE_2__.i.TORUS_SOLANA});try{return await this.torusInstance.login(this.loginSettings),await this.solanaProvider.setupProvider(this.torusInstance.provider),this.status=_web3auth_base__WEBPACK_IMPORTED_MODULE_2__.d.CONNECTED,this.torusInstance.showTorusButton(),this.emit(_web3auth_base__WEBPACK_IMPORTED_MODULE_2__.d.CONNECTED,{adapter:_web3auth_base__WEBPACK_IMPORTED_MODULE_2__.i.TORUS_SOLANA,reconnected:this.rehydrated}),this.provider}catch(error){throw this.status=_web3auth_base__WEBPACK_IMPORTED_MODULE_2__.d.READY,this.rehydrated=!1,this.emit(_web3auth_base__WEBPACK_IMPORTED_MODULE_2__.b.ERRORED,error),_web3auth_base__WEBPACK_IMPORTED_MODULE_2__.k.connectionError("Failed to login with torus solana wallet")}}async disconnect(){let options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{cleanup:!1};if(this.status!==_web3auth_base__WEBPACK_IMPORTED_MODULE_2__.d.CONNECTED)throw _web3auth_base__WEBPACK_IMPORTED_MODULE_2__.k.notConnectedError("Not connected with wallet");if(!this.torusInstance)throw _web3auth_base__WEBPACK_IMPORTED_MODULE_2__.j.notReady("Torus wallet is not initialized");await this.torusInstance.logout(),options.cleanup?(this.status=_web3auth_base__WEBPACK_IMPORTED_MODULE_2__.d.NOT_READY,this.torusInstance=null,this.solanaProvider=null):this.status=_web3auth_base__WEBPACK_IMPORTED_MODULE_2__.d.READY,this.emit(_web3auth_base__WEBPACK_IMPORTED_MODULE_2__.b.DISCONNECTED)}async getUserInfo(){if(this.status!==_web3auth_base__WEBPACK_IMPORTED_MODULE_2__.d.CONNECTED)throw _web3auth_base__WEBPACK_IMPORTED_MODULE_2__.k.notConnectedError("Not connected with wallet");if(!this.torusInstance)throw _web3auth_base__WEBPACK_IMPORTED_MODULE_2__.j.notReady("Torus wallet is not initialized");return await this.torusInstance.getUserInfo()}setAdapterSettings(_){}}},"./node_modules/is-stream/index.js":function(module,exports,__webpack_require__){"use strict";const isStream=stream=>null!==stream&&"object"==typeof stream&&"function"==typeof stream.pipe;isStream.writable=stream=>isStream(stream)&&!1!==stream.writable&&"function"==typeof stream._write&&"object"==typeof stream._writableState,isStream.readable=stream=>isStream(stream)&&!1!==stream.readable&&"function"==typeof stream._read&&"object"==typeof stream._readableState,isStream.duplex=stream=>isStream.writable(stream)&&isStream.readable(stream),isStream.transform=stream=>isStream.duplex(stream)&&"function"==typeof stream._transform,module.exports=isStream}}]);